apiVersion: thoth-station.ninja/v1
kind: prescription
spec:
  release: 2020.03.18
  units:
    boots:
      - name: BootUnit
        type: boot
        should_include:
          adviser_pipeline: true
        run:
          log:
            message: "Hello, Thoth!"
            type: "WARNING"
    pseudonyms:
      - name: PseudonymUnit
        type: pseudonym
        should_include:
          adviser_pipeline: true
        run:
          match:
            package_version:
              name: flask
              version: '>1.0,<=1.1.0'
              index_url: 'https://pypi.org/simple'

          yield:
            package_version:
              name: flask
              locked_version: '==1.2.0'
              index_url: 'https://pypi.org/simple'
    sieves:
      - name: SieveUnit
        type: sieve
        should_include:
          adviser_pipeline: true
        run:
          match:
            package_version:
              name: flask
              version: '>1.0,<=1.1.0'
              index_url: 'https://pypi.org/simple'
    steps:
      - name: StepUnit
        type: step
        should_include:
          adviser_pipeline: true
        run:
          match:
            package_version:
              name: flask
              version: '>1.0<=1.1.0'
              index_url: 'https://pypi.org/simple'
          score: 0.42
    strides:
      - name: StrideUnit
        type: stride
        should_include:
          adviser_pipeline: true
        run:
          match:
            state:
              resolved_dependencies:
                - name: werkzeug
                  version: "==1.0.0"
                  index_url: 'https://pypi.org/simple'
          eager_stop_pipeline: "Stopping the pipeline"
    wraps:
      - name: WrapUnit
        type: wrap
        should_include:
          adviser_pipeline: true
        run:
          match:
            state:
              resolved_dependencies:
                - name: werkzeug
                  version: "==1.0.0"
                  index_url: 'https://pypi.org/simple'
          justification:
            - message: "Some justification printed"
              type: "WARNING"
              link: some_link
